{{- $data := fromToml (include ".chezmoidata.toml") -}}
{{- $host := (index ($data.hosts | default (dict)) .chezmoi.hostname) | default (dict) -}}
{{- $roles := (index $host "roles") | default (list) -}}

# Keychain-backed environment variables
# -------------------------------------
# Add one line per secret you want exported in every shell.
# Format:
#   __load_secret_from_keychain <VAR_NAME> <keychain service name>
#
# The defaults below cover typical API tokens. Extend as needed.

__load_secret_from_keychain OPENAI_API_KEY dev.openai.api
__load_secret_from_keychain SAGE_GITHUB_TOKEN dev.sage.github
__load_secret_from_keychain HF_TOKEN dev.huggingface.token
{{- if has "work" $roles }}
__load_secret_from_keychain ARTIFACTORY_ENTERPRISE_NPM_AUTH_TOKEN dev.artifactory.enterprise.npm
{{- end }}

# Mirror HF_TOKEN for tooling that expects the alternative variable name.
if set -q HF_TOKEN
    set -gx HUGGINGFACE_HUB_TOKEN $HF_TOKEN
end
