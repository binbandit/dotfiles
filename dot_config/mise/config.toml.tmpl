{{- $data := fromToml (include ".chezmoidata.toml") -}}
{{- $defaults := $data.defaults | default (dict) -}}
{{- $host := (index ($data.hosts | default (dict)) .chezmoi.hostname) | default (dict) -}}
{{- $miseDefaults := (index $defaults "mise") | default (dict) -}}
{{- $miseHost := (index $host "mise") | default (dict) -}}
{{- $tools := merge ((index $miseDefaults "tools") | default (dict)) ((index $miseHost "tools") | default (dict)) -}}

[tools]
{{ range $name := sortAlpha (keys $tools) -}}
{{- $key := $name -}}
{{- if not (regexMatch "^[0-9A-Za-z_-]+$" $name) -}}
{{- $key = printf "%q" $name -}}
{{- end -}}
{{ printf "%s = %q\n" $key (index $tools $name) -}}
{{- end }}
